{"ast":null,"code":"var _jsxFileName = \"/Users/james/Desktop/et/et/src/Components/Login.js\";\nimport React from 'react';\nimport firebase from './firebaseConfig';\nimport ErrorBox from './ErrorBox';\nimport './App.css';\nimport { NavLink } from 'react-router-dom';\nexport default class Login extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      cellNo: '',\n      pin: '',\n      userPin: '',\n      error: ''\n    };\n  }\n\n  componentDidMount() {\n    this.checkLoggedIn();\n    alert(\"x\");\n    document.getElementsByClassName(\"signedOutContainer\")[0].style.height = window.innerHeight + 'px';\n    setTimeout(() => {\n      document.getElementsByClassName(\"signedOutContainer\")[0].classList.toggle(\"signedOutContainerShowing\");\n    }, 1400);\n    this.checkLoggedIn();\n    setInterval(() => {\n      this.altColour();\n    }, 4000);\n  }\n\n  checkLoggedIn() {\n    var user = localStorage.getItem('oc_user');\n    console.log(user);\n\n    if (user) {\n      window.location.href = \"/home\";\n    }\n  }\n\n  verifyCellNo() {\n    var cell = this.state.cellNo;\n\n    if (cell.length == 10) {\n      document.getElementsByClassName(\"confirmPIN\")[0].classList.toggle(\"confirmPINShowing\");\n      this.sendSMS();\n    } else {\n      this.setState({\n        error: \"Invalid phone number entered\"\n      });\n      this.callError();\n      this.animateNo(document.getElementsByClassName(\"registrationPanel\")[0], document.getElementById(\"cellphone\"));\n    }\n  }\n\n  altColour() {\n    var colours = [\"#FFDAC1\", \"#C7CEEA\", \"#E2F0CB\", \"#B5EAD7\", \"#FF9AA2\", \"#AFC7D0\"];\n    var rand = parseInt(Math.random() * (colours.length - 1));\n    console.log(rand, colours[rand]);\n    document.getElementsByClassName(\"signedOutContainerShowing\")[0].style.backgroundColor = colours[rand];\n    document.getElementsByClassName(\"signedOutContainerShowing\")[0].style.transition = '4s';\n  }\n\n  verifyPIN() {\n    if (this.state.pin == this.state.userPin) {\n      var oc_email = this.state.cellNo + '_oc' + this.state.pin + '@onecab.co.za';\n      console.log(oc_email);\n      var password = this.state.pin + '_oc';\n      firebase.auth().createUserWithEmailAndPassword(oc_email, password).then(result => {\n        var user = firebase.auth().currentUser;\n        console.log(user);\n        localStorage.setItem('oc_user', JSON.stringify(user));\n        window.location.href = \"/home\";\n      });\n    } else {\n      //show error\n      this.setState({\n        error: \"Invalid PIN entered\"\n      });\n      this.callError();\n      var pin = document.getElementsByClassName(\"confirmPINShowing\")[0];\n      this.animateNo(pin, document.getElementById(\"cellphone1\"));\n    }\n  }\n\n  callError() {\n    var errorBox = document.getElementsByClassName(\"errorBox\")[0];\n    errorBox.classList.toggle(\"errorShowing\");\n    setTimeout(() => {\n      errorBox.classList.toggle(\"errorShowing\");\n    }, 2500);\n  }\n\n  animateNo(pin, input) {\n    pin.style.marginLeft = \"-4%\";\n    setTimeout(() => {\n      pin.style.marginLeft = \"4%\";\n      pin.style.transition = \".25s\";\n    }, 250);\n    setTimeout(() => {\n      pin.style.marginLeft = \"-3%\";\n      pin.style.transition = \".25s\";\n    }, 500);\n    setTimeout(() => {\n      pin.style.marginLeft = \"2%\";\n      pin.style.transition = \".25s\";\n      input.value = \"\";\n    }, 650);\n    setTimeout(() => {\n      pin.style.marginLeft = \"1%\";\n      pin.style.transition = \".25s\";\n    }, 900);\n    setTimeout(() => {\n      pin.style.marginLeft = \"0%\";\n      pin.style.transition = \".70s\";\n    }, 901);\n  }\n\n  sendSMS() {\n    var pin = Math.floor(Math.random() * 100000);\n    this.setState({\n      pin: pin\n    });\n    console.log(pin);\n    var number = this.state.cellNo.replace('0', '27');\n    var body = `Your Onecab verification is ${pin}`;\n    var cors = 'https://cors-anywhere.herokuapp.com';\n    var sms = 'https://api.bulksms.com/v1/messages/send?to=' + number + '&body=' + body;\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', cors + '/' + sms, true);\n    xhr.setRequestHeader('path', 'api.bulksms.com/v1/messages/send?');\n    xhr.setRequestHeader('Authority', 'api.bulksms.com');\n    xhr.setRequestHeader('scheme', 'https');\n    xhr.setRequestHeader('origin', 'https://onecab.co.za');\n    xhr.setRequestHeader('Access-Control-Allow-Origin', 'https://onecab.co.za');\n    xhr.setRequestHeader('Authorization', 'Basic emlwaTpaaXBpMTIzNDU2');\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState == '4') {\n        console.log(\"Success\");\n      } else {\n        console.log(\"Unable to send...\");\n      }\n    }; //xhr.send();\n\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"signedOutContainer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ErrorBox, {\n      error: this.state.error,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"confirmPIN\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"h2\", {\n      id: \"welcome-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }\n    }, \"Verification\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 56\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      id: \"welcome-small-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 21\n      }\n    }, \"We've sent a verification PIN to \", this.state.cellNo, \". Please enter the PIN below:\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 133\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"number\",\n      onChange: text => {\n        this.setState({\n          userPin: text.target.value\n        });\n      },\n      style: {\n        marginLeft: 20\n      },\n      id: \"cellphone1\",\n      \"max-length\": \"10\",\n      placeholder: \"Verification PIN\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 196\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"submitLogin\",\n      style: {\n        marginLeft: 20\n      },\n      onClick: () => {\n        this.verifyPIN();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 21\n      }\n    }, \"Finish\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 26\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"negative\",\n      style: {\n        marginLeft: 20\n      },\n      onClick: () => {\n        this.verifyCellNo();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 21\n      }\n    }, \"Re-enter Phone Number\")), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"h2\", {\n      id: \"welcome-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 13\n      }\n    }, \"Welcome.\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 48\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      id: \"welcome-small-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    }, \"Onecab is the fresh, new and affordable. By keeping our operations lean, small and agile we save you money on every journey that you take with us.\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 122\n      }\n    }), /*#__PURE__*/React.createElement(\"fieldset\", {\n      className: \"registrationPanel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"center\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      id: \"smallTitle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 13\n      }\n    }, \"Create your account\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"number\",\n      onChange: text => {\n        this.setState({\n          cellNo: text.target.value\n        });\n      },\n      id: \"cellphone\",\n      \"max-length\": \"10\",\n      placeholder: \"Cellphone Number\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 161\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"submitLogin\",\n      onClick: () => {\n        this.verifyCellNo();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 13\n      }\n    }, \"Continue\"))));\n  }\n\n}","map":{"version":3,"sources":["/Users/james/Desktop/et/et/src/Components/Login.js"],"names":["React","firebase","ErrorBox","NavLink","Login","Component","constructor","state","cellNo","pin","userPin","error","componentDidMount","checkLoggedIn","alert","document","getElementsByClassName","style","height","window","innerHeight","setTimeout","classList","toggle","setInterval","altColour","user","localStorage","getItem","console","log","location","href","verifyCellNo","cell","length","sendSMS","setState","callError","animateNo","getElementById","colours","rand","parseInt","Math","random","backgroundColor","transition","verifyPIN","oc_email","password","auth","createUserWithEmailAndPassword","then","result","currentUser","setItem","JSON","stringify","errorBox","input","marginLeft","value","floor","number","replace","body","cors","sms","xhr","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","render","text","target"],"mappings":"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","sourcesContent":["import React from 'react';\nimport firebase from './firebaseConfig';\nimport ErrorBox from './ErrorBox';\nimport './App.css';\nimport { NavLink } from 'react-router-dom';\n\n\nexport default class Login extends React.Component{\n    constructor(){\n        super();\n        this.state = {\n            cellNo: '',\n            pin: '',\n            userPin: '',\n            error: ''\n        }\n    }\n\n\n    componentDidMount(){\n        this.checkLoggedIn();\n        alert(\"x\");\n        document.getElementsByClassName(\"signedOutContainer\")[0].style.height = window.innerHeight + 'px';\n        setTimeout(()=>{document.getElementsByClassName(\"signedOutContainer\")[0].classList.toggle(\"signedOutContainerShowing\")},1400);\n        this.checkLoggedIn();\n        setInterval(()=>{this.altColour()}, 4000);\n    }\n\n\n    checkLoggedIn(){\n        var user = localStorage.getItem('oc_user');\n        console.log(user);\n        if(user){\n            window.location.href = \"/home\";\n        }\n    }\n\n    verifyCellNo(){\n        var cell = this.state.cellNo;\n        if(cell.length == 10){\n        document.getElementsByClassName(\"confirmPIN\")[0].classList.toggle(\"confirmPINShowing\");\n        this.sendSMS();\n        }else{\n            this.setState({error: \"Invalid phone number entered\"});\n            this.callError();\n            this.animateNo(document.getElementsByClassName(\"registrationPanel\")[0], document.getElementById(\"cellphone\"));\n        }\n    }\n\n    altColour(){\n        var colours = [\"#FFDAC1\",\"#C7CEEA\",\"#E2F0CB\",\"#B5EAD7\",\"#FF9AA2\",\"#AFC7D0\"];\n        var rand = parseInt(Math.random()*(colours.length - 1));\n        console.log(rand,colours[rand]);\n        document.getElementsByClassName(\"signedOutContainerShowing\")[0].style.backgroundColor = colours[rand];\n        document.getElementsByClassName(\"signedOutContainerShowing\")[0].style.transition = '4s';\n    }\n\n    verifyPIN(){\n        if(this.state.pin == this.state.userPin){\n            \n            var oc_email = this.state.cellNo + '_oc'+this.state.pin+'@onecab.co.za';\n            console.log(oc_email);\n            var password = this.state.pin + '_oc';\n            firebase.auth().createUserWithEmailAndPassword(oc_email, password).then(result => {\n                    var user = firebase.auth().currentUser;\n                    console.log(user);\n                    localStorage.setItem('oc_user', JSON.stringify(user));\n                    window.location.href = \"/home\";\n            });\n        }else{\n            //show error\n            this.setState({error: \"Invalid PIN entered\"});\n            this.callError();\n            var pin = document.getElementsByClassName(\"confirmPINShowing\")[0];\n            this.animateNo(pin, document.getElementById(\"cellphone1\"));\n        }\n    }\n\n    callError(){\n        var errorBox = document.getElementsByClassName(\"errorBox\")[0];\n        errorBox.classList.toggle(\"errorShowing\");\n        setTimeout(()=>{errorBox.classList.toggle(\"errorShowing\")}, 2500);\n    }\n\n    animateNo(pin, input){\n        pin.style.marginLeft = \"-4%\";\n            setTimeout(()=>{pin.style.marginLeft = \"4%\"; pin.style.transition = \".25s\"}, 250);\n            setTimeout(()=>{pin.style.marginLeft = \"-3%\"; pin.style.transition = \".25s\"}, 500);\n            setTimeout(()=>{pin.style.marginLeft= \"2%\"; pin.style.transition = \".25s\"; input.value = \"\"}, 650);\n            setTimeout(()=>{pin.style.marginLeft = \"1%\"; pin.style.transition = \".25s\"}, 900);\n            setTimeout(()=>{pin.style.marginLeft = \"0%\"; pin.style.transition = \".70s\"}, 901);\n    }\n\n    sendSMS(){\n        var pin = Math.floor(Math.random()*100000);\n        this.setState({pin: pin});\n        console.log(pin);\n        var number = this.state.cellNo.replace('0','27');\n        var body = `Your Onecab verification is ${pin}`;\n        var cors = 'https://cors-anywhere.herokuapp.com';\n        var sms = 'https://api.bulksms.com/v1/messages/send?to='+number+'&body='+body;\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', cors+'/'+sms, true);\n        xhr.setRequestHeader('path', 'api.bulksms.com/v1/messages/send?');\n        xhr.setRequestHeader('Authority', 'api.bulksms.com');\n        xhr.setRequestHeader('scheme','https');\n        xhr.setRequestHeader('origin', 'https://onecab.co.za');\n        xhr.setRequestHeader('Access-Control-Allow-Origin', 'https://onecab.co.za');\n        xhr.setRequestHeader('Authorization', 'Basic emlwaTpaaXBpMTIzNDU2');\n        xhr.onreadystatechange = () => {\n        if(xhr.readyState == '4'){\n          console.log(\"Success\");\n          }else{\n          console.log(\"Unable to send...\");\n          }\n          }\n        //xhr.send();\n        }\n\n\n    render(){\n        return(\n            <div className=\"signedOutContainer\">\n                <ErrorBox error={this.state.error}/>\n                <div className=\"confirmPIN\">\n                <br/>\n                <h2 id=\"welcome-text\">Verification</h2><br/>\n                    <p id=\"welcome-small-text\">We've sent a verification PIN to {this.state.cellNo}. Please enter the PIN below:</p><br/>\n                    <input type=\"number\" onChange={(text)=>{this.setState({userPin: text.target.value})}} style={{marginLeft: 20}} id=\"cellphone1\" max-length=\"10\" placeholder=\"Verification PIN\"/><br/>\n                    <button id=\"submitLogin\" style={{marginLeft: 20}} onClick={()=>{this.verifyPIN()}}>Finish</button>\n                    <br/><br/>\n                    <button id=\"negative\" style={{marginLeft: 20}} onClick={()=>{this.verifyCellNo()}}>Re-enter Phone Number</button>\n                </div>\n\n\n            <br/>\n            <h2 id=\"welcome-text\">Welcome.</h2><br/>\n            <p id=\"welcome-small-text\">Onecab is the fresh, new and affordable.\n            By keeping our operations lean, small and agile we save you money on every journey that you take with us.</p><br/>\n\n            <fieldset className=\"registrationPanel\">\n            <center>\n            <p id=\"smallTitle\">\n            Create your account\n            </p><br/>\n            <input type=\"number\" onChange={(text)=>{this.setState({cellNo: text.target.value})}} id=\"cellphone\" max-length=\"10\" placeholder=\"Cellphone Number\"/><br/>\n            <button id=\"submitLogin\" onClick={()=>{this.verifyCellNo()}}>Continue</button>\n            </center>\n            </fieldset>\n            </div>\n        );\n    }\n\n}"]},"metadata":{},"sourceType":"module"}